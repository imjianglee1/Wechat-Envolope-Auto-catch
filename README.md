# WeChat-Envelope-Auto-catch 自动抢红包脚本

**声明：** 本项目仅供学习与技术研究参考。请勿将其用于干扰微信正常运行、破坏群聊氛围或任何违反社会公德及相关法律法规的行为。

本项目是一个基于 **OCR 与图像识别技术** 的自动抢红包脚本，通过 Python、OpenCV、PyAutoGUI 等技术实现全自动操作。

---

## 环境配置要求

### 1. 运行环境
* **模拟环境：** 一台安卓设备模拟器（如雷电、某逍遥等）。
* **Python 版本：** 建议使用 **Python 3.8 ~ 3.11** 之间的版本（避免因版本过新导致库不兼容）。

### 2. 核心依赖库
* **OpenCV (cv2)：** 用于图像模板匹配，计算模板图像在屏幕截图中的位置。
* **PyAutoGUI：** 用于屏幕截图和模拟鼠标点击。
* **NumPy：** 辅助图像数据处理。

### 3. 安装依赖
```bash
pip install requirements.txt
```
### 特点
* 采用了 mss 库替代传统的 pyautogui 截图，大幅提升了屏幕捕获帧率，降低了抢红包的延迟。

## 关键参数说明

你可以通过修改代码中 `if __name__ == "__main__":` 下方的变量来微调脚本性能：

| 参数名称 | 功能描述 | 建议设置 |
| :--- | :--- | :--- |
| **THRESHOLD** | 图像匹配度阈值。设置太低容易误点，太高则识别不到。 | 0.8 - 0.9 |
| **INTERVAL** | 屏幕扫描频率（秒）。值越小抢得越快，但会增加 CPU 负担。 | 0.05 |
| **POST_CLICK_DELAY** | 点击红包图标后的缓冲时间，等待弹出“开”的窗口。 | 0.03 - 0.1 |
| **OPEN_BUTTON_TIMEOUT** | 等待“开”按钮出现的上限时间，防止卡死在红包界面。 | 1.0 - 1.5 |
| **ANIMATION_DELAY** | 点击“开”之后，停留在红包金额页面的时间，随后执行 Esc。 | 1.5 - 3.0 |

---

## 常见问题排查

1. **无法识别图像：** 请确认 `RED_PACKET_PATH` 等路径下的图片是你从模拟器截取的原图。不同分辨率的模拟器，图片像素大小不同。
2. **权限错误：** 请以管理员权限运行终端或 IDE，确保 `pyautogui` 有权控制鼠标点击。
3. **坐标偏移：** 确保模拟器缩放比例为 100%，否则 `pyautogui` 的点击位置可能会偏离目标中心。