Wechat-Envolope-Auto-catch 自动抢红包脚本

**!仅供学习与参考，不可用于扰乱微信团队，群聊良好氛围，社会良好风气等不良内容**

**📧 联系方式**

任何问题欢迎反馈至邮箱：notxcm@yeah.net

**声明：本项目使用 deepseek 工具进行辅助创作**

**📖 项目简介**

本项目是一个基于 OCR 图像识别的自动抢红包脚本，通过 Python、OpenCV、PyAutoGUI 等技术实现全自动操作。程序能够自动识别屏幕中的红包图标并完成点击、拆包、返回等一系列操作，全程无需人工干预。

**✨ 功能特性**

· 🎯 红包自动识别：通过图像模板匹配技术，准确识别屏幕中的红包图标

· 🔄 全自动流程：自动完成"点击红包 → 点击打开 → 返回"的完整抢红包流程

· ⏱️ 超时跳过机制：若在指定时间内未检测到"打开"按钮，自动跳过并返回，避免卡死

· 📊 实时日志输出：终端显示每一步操作的坐标、置信度和状态信息

· ⚙️ 参数可配置：阈值、检测间隔、点击延迟、超时时间等关键参数均可调整

**🏗️ 实现方案**

程序采用顺序状态机模式实现：

· 第一阶段：循环匹配红包模板（阈值 ≥ 0.8），点击后进入下一阶段
· 第二阶段：启动计时器，若在超时时间（默认1秒）内检测到"打开"按钮则点击，否则自动跳过
· 第三阶段：检测"返回"按钮并点击，重新开始循环

**📋 环境配置**

系统要求

· 一台运行安卓模拟器的设备（如雷电、MuMu、蓝叠等）
· Python 3.x（推荐版本 3.8 ~ 3.11）

依赖安装

```bash
# 安装 PyAutoGUI - 用于屏幕截图和模拟鼠标点击
pip install pyautogui

# 安装 OpenCV - 用于图像模板匹配
pip install opencv-python

# 安装 NumPy - 辅助图像数据处理（通常随 OpenCV 自动安装）
```

**🚀 快速开始**

1. 准备模板图片
   · 将红包模板图片（如 red_packet.png）、打开按钮模板（如 open_button.png）和返回按钮模板（如 back_button.png）放置在项目目录中
2. 配置图片路径
   · 修改脚本中的模板图片路径，指向你存放的图片位置
3. 启动模拟器
   · 打开安卓模拟器并登录微信，进入聊天列表界面
4. 运行脚本
   ```bash
   python auto_catch.py
   ```

**⚙️ 核心逻辑**

```python
# 核心参数配置示例
THRESHOLD = 0.8          # 图像匹配阈值
DETECT_INTERVAL = 0.1    # 检测间隔（秒）
CLICK_DELAY = 0.1        # 点击后延迟（秒）
OPEN_TIMEOUT = 1.0       # 打开按钮超时（秒）
```

##详细流程##

1. 第一阶段：查找红包
   · 不断截取屏幕，与红包模板进行匹配（cv2.matchTemplate）
   · 当匹配度达到阈值时，获取目标中心坐标，使用 pyautogui.click 模拟点击
   · 点击后等待固定延迟，确保界面切换
2. 第二阶段：查找打开按钮（带超时）
   · 进入本阶段后开始计时
   · 若在超时时间内检测到"打开"按钮，则点击它，并等待延迟
   · 若超时未找到，则打印提示并跳过该阶段，直接进入第三阶段
3. 第三阶段：查找返回按钮
   · 检测"返回"按钮，点击后返回主界面
   · 等待延迟后，重新从第一阶段开始下一轮循环

**📂 项目文件**

· auto_catch.py - 主程序脚本
· templates/ - 模板图片文件夹
  · red_packet.png - 红包图标模板
  · open_button.png - 打开按钮模板
  · back_button.png - 返回按钮模板
· requirements.txt - 依赖包列表

<img width="1410" height="663" alt="image" src="https://github.com/user-attachments/assets/dc52d34e-17c0-4371-a4b7-8ce8282b5aea" />
**这些需要自定义路径，我放在github附件上了**

**🎥 运行效果**

运行脚本后，终端会实时输出：

· 检测到的红包坐标和置信度
· 点击操作状态
· 超时跳过提示
· 流程阶段切换信息

同时可以看到鼠标在屏幕上自动移动并点击，完成抢红包的全过程。

**⚠️ 注意事项**

· 请确保模拟器分辨率稳定，避免界面缩放导致模板匹配失败
· 模板图片需与屏幕中的实际图标保持一致（包括颜色、大小）
· 建议在测试环境中先调试好参数再投入使用
· 请合理使用本脚本，遵守微信用户协议和社区规范


**样例视频**：





https://github.com/user-attachments/assets/e6786f5a-41e8-4820-beae-694dca60e6a9






实际运行中，您可以通过屏幕观察鼠标的自动点击动作，并在终端中查看实时日志，了解程序执行进度。
